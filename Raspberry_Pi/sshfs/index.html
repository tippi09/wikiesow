



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>SSHFS hard drive sharing - Coding</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Montserrat","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#sshfs-hard-drive-sharing" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://saschakiesow.de" title="Coding" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Coding
            </span>
            <span class="md-header-nav__topic">
              SSHFS hard drive sharing
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/tippi09/wikiesow/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tippi09/wikiesow
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Coding" class="md-nav__button md-logo">
      
        <img src="../../images/logo.png" width="48" height="48">
      
    </a>
    Coding
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/tippi09/wikiesow/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tippi09/wikiesow
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Coding Wiki" class="md-nav__link">
      Coding Wiki
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Raspberry Pi
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Raspberry Pi
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../irremote/" title="Improving Raspotify by configuring a LIRC IR remote (coming soon)" class="md-nav__link">
      Improving Raspotify by configuring a LIRC IR remote (coming soon)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../openvpn/" title="OpenVPN over IPv6" class="md-nav__link">
      OpenVPN over IPv6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../semihead/" title="Multi-purpose Raspbian setup" class="md-nav__link">
      Multi-purpose Raspbian setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssh6/" title="SSH over IPv6" class="md-nav__link">
      SSH over IPv6
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        SSHFS hard drive sharing
      </label>
    
    <a href="./" title="SSHFS hard drive sharing" class="md-nav__link md-nav__link--active">
      SSHFS hard drive sharing
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#raspberry-pi-configuration" title="Raspberry Pi configuration" class="md-nav__link">
    Raspberry Pi configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computer-configuration" title="Computer configuration" class="md-nav__link">
    Computer configuration
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      macOS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        macOS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../macOS/basic/" title="Basic macOS setup" class="md-nav__link">
      Basic macOS setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macOS/bitbar/" title="BitBar: Menu bar plugins" class="md-nav__link">
      BitBar: Menu bar plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../macOS/uebersicht/" title="Übersicht: System monitor configuration" class="md-nav__link">
      Übersicht: System monitor configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#raspberry-pi-configuration" title="Raspberry Pi configuration" class="md-nav__link">
    Raspberry Pi configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computer-configuration" title="Computer configuration" class="md-nav__link">
    Computer configuration
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/tippi09/wikiesow/edit/master/docs/Raspberry_Pi/sshfs.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="sshfs-hard-drive-sharing">SSHFS hard drive sharing<a class="headerlink" href="#sshfs-hard-drive-sharing" title="Permanent link">&para;</a></h1>
<p>In this guide I will explain how I have implemented easy hard drive sharing on my Raspberry Pi by using <code class="codehilite">sshfs</code>.</p>
<h2 id="raspberry-pi-configuration">Raspberry Pi configuration<a class="headerlink" href="#raspberry-pi-configuration" title="Permanent link">&para;</a></h2>
<p>First of all we have to install some packages. Depending on the file system you are using, it must not be necessary to install the exFAT packages.</p>
<div class="codehilite"><pre><span></span><span class="gp">#</span> sudo apt-get install exfat-fuse exfat-utils
<span class="gp">#</span> sudo apt-get install hdparm
</pre></div>

<p>The <code class="codehilite">hdparm</code> package will be used later to set the hard drive to standby and reduce energy consumption if it is not mounted. After installing the required packages we first have to find the hard drive we want to mount:</p>
<div class="codehilite"><pre><span></span><span class="gp">#</span> sudo lsblk -o name,mountpoint,label,size,uuid
</pre></div>

<p>This command should produce information about all connected drives:
<div class="codehilite"><pre><span></span>NAME        MOUNTPOINT LABEL   SIZE UUID
sda                            3,7T
├─sda1                 EFI     200M 67E3-17ED
└─sda2                 HiFiPi  3,7T 5B8D-1D20
mmcblk0                       29,7G
├─mmcblk0p1 /boot      boot   43,9M AF14-47C0
└─mmcblk0p2 /          rootfs 29,7G b57a7299-0677-4dc6-b4b0-c10f107f0f6d
</pre></div></p>
<p>In this case <code class="codehilite">mmcblk0</code> is the SD card of the Pi and <code class="codehilite">sda</code> the hard drive we want to mount. With <code class="codehilite">hdparm</code> we can find out the current power status by running <code class="codehilite">sudo hdparm -C /dev/sda</code>. It is also possible to use the disks label with <code class="codehilite">sudo hdparm -C /dev/disk/by-label/HiFiPi</code>. If you get the output <code class="codehilite">drive state is:  unknown</code>, your disk controller does not support <code class="codehilite">hdparm</code> and you should try to use <code class="codehilite">hd-idle</code> instead.</p>
<p>To mount the hard drive, I have written a small script which also sets the drive to standby if it is unmounted. This script will also be used to start the drive again from accessing computer:</p>
<div class="codehilite"><pre><span></span><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;mount&quot;</span> <span class="o">]</span>
<span class="k">then</span>
    mkdir /home/«piuser»/«pimountdirectory»
    sudo mount -L HiFiPi /home/«piuser»/«pimountdirectory»
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;unmount&quot;</span> <span class="o">]</span>
<span class="k">then</span>
    sudo umount /home/«piuser»/«pimountdirectory»
    sudo rm -rf /home/«piuser»/«pimountdirectory»
    sudo hdparm -y /dev/disk/by-label/HiFiPi
<span class="k">fi</span>
</pre></div>

<p>In the following this script is named «pimount.sh» and it is located in the home directory. To make it executable first run <code class="codehilite">chmod +x «pimount.sh»</code>. Then run <code class="codehilite">sudo visudo</code> and add the following line:
<div class="codehilite"><pre><span></span>«username» ALL= NOPASSWD: /home/«username»/pimount.sh
</pre></div></p>
<p>Now it should be possible to mount the hard drive with <code class="codehilite">./«pimount.sh» mount</code> and unmount by running <code class="codehilite">./«pimount.sh» unmount</code>.</p>
<h2 id="computer-configuration">Computer configuration<a class="headerlink" href="#computer-configuration" title="Permanent link">&para;</a></h2>
<p>First we have to install <code class="codehilite">sshfs</code>. This can easily done with Homebrew by running:
<div class="codehilite"><pre><span></span><span class="gp">#</span> brew install sshfs
</pre></div>
Now I have added another «pimount.sh» script in my home directory:
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;mount&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    mkdir /Users/«user»/«mountdirectory»
    ssh -t «piuser»@«pihostname» <span class="s2">&quot;sudo ./pimount.sh </span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="c1"># Mount drive on Raspberry</span>
    sshfs «piuser»@«pihostname»:/home/«piuser»/«pimountdirectory» /Users/«user»/«mountdirectory»
    <span class="nb">exit</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;unmount&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    ssh -t «piuser»@«pihostname» <span class="s2">&quot;sudo ./pimount.sh </span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="c1"># Run unmount script on Raspberry</span>
    umount -f /Users/«user»/«mountdirectory»
    rm -rf /Users/«user»/«mountdirectory»
    <span class="nb">exit</span>
<span class="k">fi</span>
</pre></div>
Once again make it executable with <code class="codehilite">chmod +x «pimount.sh»</code>. Now I have added two aliases in my <code class="codehilite"><span class="na">.zshrc</span></code>, to mount the hard drive with a single command in the terminal:
<div class="codehilite"><pre><span></span>alias pimount=&#39;/Users/«user»/pimount.sh mount&#39;
alias piunmount=&#39;/Users/«user»/pimount.sh unmount&#39;
</pre></div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ssh6/" title="SSH over IPv6" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                SSH over IPv6
              </span>
            </div>
          </a>
        
        
          <a href="../../macOS/basic/" title="Basic macOS setup" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Basic macOS setup
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019 Sascha Kiesow
          </div>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>